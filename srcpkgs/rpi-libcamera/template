# Template file for 'rpi-libcamera'
_githash="923f5d707bb760bd3e724b3373568fa88c68454f"

pkgname=rpi-libcamera
version=20230303
revision=1
archs="armv6l* armv7l* aarch64*"
build_style=meson
hostmakedepends="pkg-config python3-yaml python3-ply python3-Jinja2 libcrypto1.1"
makedepends="libyaml-devel gnutls-devel"
short_desc="Raspberry Pi's clone of libcamera"
maintainer="Petr Cizmar <xxb0322@xpc.ovh>"
license="LGPL-2.1-or-later"
homepage="https://github.com/raspberrypi/libcamera"
distfiles="https://github.com/raspberrypi/libcamera/archive/${_githash}.tar.gz"
checksum="ce3047b491308cf8027faf9ee3538d9d53e3b62e18ce39f282d6f84789ed57c5"

if [ "$XBPS_TARGET_NO_ATOMIC8" ]; then
	makedepends+=" libatomic-devel"
fi

rpi-libcamera-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.so"
	}
}
